{"version":3,"sources":["webpack:///./src/views/Chat.vue?b502","webpack:///./src/components/ChatMessage.vue?b5a0","webpack:///src/components/ChatMessage.vue","webpack:///./src/components/ChatMessage.vue?6e8d","webpack:///./src/components/ChatMessage.vue","webpack:///src/views/Chat.vue","webpack:///./src/views/Chat.vue?cbed","webpack:///./src/views/Chat.vue","webpack:///./src/views/Chat.vue?bb17","webpack:///./src/components/ChatMessage.vue?7a61"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","otherPersonAvatar","_v","_s","otherPersonName","chat","ChatMessages","length","_l","message","key","userType","_e","model","value","callback","$$v","expression","isLoading","on","sendMessage","staticRenderFns","class","author","text","isSeen","props","type","required","component","VCard","VIcon","components","ChatMessage","data","methods","avatar","require","getChat","id","readMessages","$callWithErrorHandler","computed","beforeMount","VBtn","VContainer","VImg","VTextField"],"mappings":"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","file":"js/chunk-1ac2271e.4c3520e3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',[_c('v-card',{staticClass:\"chat\"},[_c('div',{staticClass:\"chat-header\"},[_c('v-img',{staticClass:\"avatar\",attrs:{\"max-width\":\"128\",\"max-height\":\"128\",\"src\":_vm.otherPersonAvatar}}),_c('h2',{staticClass:\"mb-2\"},[_vm._v(_vm._s(_vm.otherPersonName))])],1),_c('div',{staticClass:\"chat-body\"},[(_vm.chat && !_vm.chat.ChatMessages.length)?_c('h1',[_vm._v(\" В этом чате еще нет сообщений \")]):(_vm.chat && _vm.chat.ChatMessages.length)?_c('div',{staticClass:\"chat-messages-container\"},_vm._l((_vm.chat.ChatMessages),function(message){return _c('chat-message',{key:(\"chat-message-\" + (message.id)),attrs:{\"message\":message,\"userType\":_vm.userType,\"otherPersonName\":_vm.otherPersonName}})}),1):_vm._e()]),_c('div',{staticClass:\"chat-footer\"},[_c('v-text-field',{attrs:{\"label\":\"Введите сообщение\"},model:{value:(_vm.message),callback:function ($$v) {_vm.message=$$v},expression:\"message\"}}),_c('v-btn',{attrs:{\"color\":\"primary\",\"disabled\":!_vm.message,\"loading\":_vm.isLoading},on:{\"click\":_vm.sendMessage}},[_vm._v(\"Отправить\")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{class:(\"chat-message chat-message-\" + (_vm.userType === _vm.message.author ? 'my' : 'not-my'))},[(_vm.message.author !== _vm.userType)?_c('h4',[_vm._v(_vm._s(_vm.otherPersonName))]):_vm._e(),_c('p',[_vm._v(_vm._s(_vm.message.text))]),(_vm.message.author === _vm.userType)?_c('div',{staticClass:\"read-mark\"},[_c('v-icon',{attrs:{\"color\":\"primary\"}},[_vm._v(_vm._s(_vm.message.isSeen ? \"mdi-check-all\" : \"mdi-check\"))])],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-card :class=\"`chat-message chat-message-${userType === message.author ? 'my' : 'not-my'}`\">\r\n    <h4 v-if=\"message.author !== userType\">{{ otherPersonName }}</h4>\r\n    <p>{{ message.text }}</p>\r\n    <div\r\n      v-if=\"message.author === userType\"\r\n      class=\"read-mark\"\r\n    >\r\n      <v-icon color=\"primary\">{{\r\n        message.isSeen ? \"mdi-check-all\" : \"mdi-check\"\r\n      }}</v-icon>\r\n    </div>\r\n  </v-card>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  props: {\r\n    message: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n    userType: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    otherPersonName: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.chat-message {\r\n    position: relative;\r\n    padding: 20px 24px 20px 20px;\r\n    margin-bottom: 16px;\r\n}\r\n\r\n.chat-message-my {\r\n    margin-left: auto;\r\n}\r\n\r\n.chat-message-not-my {\r\n    margin-right: auto;\r\n}\r\n\r\np {\r\n    margin: 0;\r\n}\r\n.read-mark {\r\n    position: absolute;\r\n    width: 16px;\r\n    height: 16px;\r\n    bottom: 16px;\r\n    right: 16px;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChatMessage.vue?vue&type=template&id=6cfac941&scoped=true&\"\nimport script from \"./ChatMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./ChatMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChatMessage.vue?vue&type=style&index=0&id=6cfac941&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6cfac941\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VCard,VIcon})\n","<template>\r\n  <v-container>\r\n    <v-card class=\"chat\">\r\n      <div class=\"chat-header\">\r\n        <v-img\r\n          class=\"avatar\"\r\n          max-width=\"128\"\r\n          max-height=\"128\"\r\n          :src=\"otherPersonAvatar\"\r\n        ></v-img>\r\n        <h2 class=\"mb-2\">{{ otherPersonName }}</h2>\r\n      </div>\r\n      <div class=\"chat-body\">\r\n        <h1 v-if=\"chat && !chat.ChatMessages.length\">\r\n          В этом чате еще нет сообщений\r\n        </h1>\r\n        <div\r\n          class=\"chat-messages-container\"\r\n          v-else-if=\"chat && chat.ChatMessages.length\"\r\n        >\r\n          <chat-message\r\n            v-for=\"message in chat.ChatMessages\"\r\n            :key=\"`chat-message-${message.id}`\"\r\n            :message=\"message\"\r\n            :userType=\"userType\"\r\n            :otherPersonName=\"otherPersonName\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <div class=\"chat-footer\">\r\n        <v-text-field label=\"Введите сообщение\" v-model=\"message\" />\r\n        <v-btn\r\n          color=\"primary\"\r\n          :disabled=\"!message\"\r\n          :loading=\"isLoading\"\r\n          @click=\"sendMessage\"\r\n          >Отправить</v-btn\r\n        >\r\n      </div>\r\n    </v-card>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport ChatMessage from \"../components/ChatMessage.vue\";\r\n\r\nexport default {\r\n  components: {\r\n    ChatMessage,\r\n  },\r\n  data() {\r\n    return {\r\n      chat: null,\r\n      message: \"\",\r\n      isLoading: false,\r\n    };\r\n  },\r\n  methods: {\r\n    avatar(avatar) {\r\n      return avatar\r\n        ? `${this.$api.BASE_URL}${avatar}`\r\n        : require(\"@/assets/default.png\");\r\n    },\r\n    async getChat() {\r\n      try {\r\n        this.chat = (await this.$api.getChat(this.$route.params.id)).data;\r\n      } catch {\r\n        this.$router.push(\"/chats\");\r\n      }\r\n    },\r\n\r\n    async sendMessage() {\r\n      if (this.message) this.isLoading = true;\r\n      await this.$callWithErrorHandler(async () => {\r\n        await this.$api.sendMessage({ id: this.chat.id, text: this.message });\r\n        this.message = \"\";\r\n        this.getChat();\r\n      });\r\n      this.isLoading = false;\r\n    },\r\n\r\n    readMessages() {\r\n      this.$callWithErrorHandler(async () => {\r\n        await this.$api.readMessages({ id: this.chat.id });\r\n        this.getChat();\r\n      });\r\n    },\r\n  },\r\n  computed: {\r\n    otherPersonName() {\r\n      return this.$store.getters.userData?.id === this.chat?.User.id\r\n        ? this.chat?.SellerProfile.name\r\n        : this.chat?.User.name;\r\n    },\r\n    otherPersonAvatar() {\r\n      return this.$store.getters.userData?.id === this.chat?.User.id\r\n        ? this.avatar(this.chat?.SellerProfile.avatar)\r\n        : this.avatar(this.chat?.User.avatar);\r\n    },\r\n    userType() {\r\n      return this.$store.getters.userData?.id === this.chat?.User.id\r\n        ? \"customer\"\r\n        : \"seller\";\r\n    },\r\n  },\r\n  async beforeMount() {\r\n    await this.getChat();\r\n    this.readMessages();\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container {\r\n  height: 100%;\r\n}\r\n.chat {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.chat-header {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 16px;\r\n  border-bottom: 1px solid #eee;\r\n  .avatar {\r\n    margin-right: 24px;\r\n  }\r\n}\r\n\r\n.chat-body {\r\n  padding: 16px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  flex: 1 0 auto;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .chat-messages-container {\r\n    height: 100%;\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-end;\r\n  }\r\n}\r\n\r\n.chat-footer {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 16px;\r\n\r\n  .v-input {\r\n    margin-right: 16px;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=5d9b077a&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&id=5d9b077a&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5d9b077a\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCard,VContainer,VImg,VTextField})\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=5d9b077a&scoped=true&lang=scss&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatMessage.vue?vue&type=style&index=0&id=6cfac941&scoped=true&lang=css&\""],"sourceRoot":""}