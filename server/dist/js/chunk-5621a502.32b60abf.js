(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5621a502"],{"2c2a":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h4",[e._v("Средняя оценка: "+e._s(e.averageReview.toFixed(1)))]),a("v-rating",{attrs:{"half-increments":"",readonly:"",length:"5",size:"32",value:e.averageReview}}),e.mutable?a("v-btn",{attrs:{color:"primary"},on:{click:e.openCreateReviewModal}},[e._v("Добавить оценку")]):e._e(),e._l(e.reviews,(function(e){return a("review",{key:"review-"+e.id,attrs:{review:e}})})),a("create-review-modal",{attrs:{isOpened:e.isCreateReviewModalOpened,shopItem:e.shopItem},on:{close:e.closeCreateReviewModal}})],2)},n=[],i=a("1da1"),o=(a("96cf"),a("d3b7"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"review-card"},[a("v-img",{staticClass:"user-avatar",attrs:{"max-width":"64",src:e.userAvatar}}),a("div",[a("h4",[e._v(e._s(e.review.User.name))]),a("p",[e._v(e._s(e.review.text))]),a("v-rating",{attrs:{"half-increments":"",readonly:"",length:"5",size:"16",value:e.review.grade}})],1)],1)}),s=[],c=(a("99af"),{props:{review:{type:Object,required:!0}},computed:{userAvatar:function(){var e;return null!==(e=this.review.User)&&void 0!==e&&e.avatar?"".concat(this.$api.BASE_URL).concat(this.review.User.avatar):a("113c")}}}),l=c,u=(a("5cfd"),a("2877")),p=a("6544"),d=a.n(p),h=a("b0af"),m=a("adda"),v=a("1d4d"),f=Object(u["a"])(l,o,s,!1,null,"24bb203c",null),g=f.exports;d()(f,{VCard:h["a"],VImg:m["a"],VRating:v["a"]});var I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"max-width":"600"},on:{"click:outside":function(t){return e.$emit("close")}},model:{value:e.isOpened,callback:function(t){e.isOpened=t},expression:"isOpened"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 grey lighten-2"},[e._v(" Создание оценки ")]),a("v-card-text",[a("v-form",{model:{value:e.isFormValid,callback:function(t){e.isFormValid=t},expression:"isFormValid"}},[a("v-text-field",{attrs:{label:"Описание",rules:e.textInputRules,"validate-on-blur":""},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}),a("v-input",{attrs:{value:e.grade,rules:e.gradeInputRules}},[a("v-rating",{attrs:{color:"primary",large:""},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}})],1)],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:"",loading:e.isLoading,disabled:!e.isFormValid},on:{click:e.createShopItem}},[e._v("Создать")])],1)],1)],1)},b=[],w={props:{isOpened:{type:Boolean,required:!0},shopItem:{type:Object,required:!0}},data:function(){return{text:"",grade:0,isFormValid:!1,isLoading:!1,textInputRules:[function(e){return!!e||"Заполните поле"},function(e){return(e||"").length>=3||"Минимальное число символов - 3"},function(e){return(e||"").length<=300||"Максимальное число символов - 300"}],gradeInputRules:[function(e){return!!e||"Заполните поле"}]}},methods:{createShopItem:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isFormValid){t.next=6;break}return e.isLoading=!0,t.next=4,e.$callWithErrorHandler(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.createReview({text:e.text,grade:e.grade,shopItemId:e.shopItem.id});case 2:case"end":return t.stop()}}),t)}))));case 4:e.isLoading=!1,e.$emit("close",!0);case 6:case"end":return t.stop()}}),t)})))()}}},x=w,C=a("8336"),R=a("99d9"),S=a("169a"),O=a("ce7e"),k=a("4bd4"),_=a("b675"),M=a("2fa4"),V=a("8654"),y=Object(u["a"])(x,I,b,!1,null,"2fc5ac33",null),$=y.exports;d()(y,{VBtn:C["a"],VCard:h["a"],VCardActions:R["a"],VCardText:R["b"],VCardTitle:R["c"],VDialog:S["a"],VDivider:O["a"],VForm:k["a"],VInput:_["a"],VRating:v["a"],VSpacer:M["a"],VTextField:V["a"]});var j={components:{Review:g,CreateReviewModal:$},props:{shopItem:{type:Object,required:!0},mutable:{type:Boolean,required:!0}},data:function(){return{reviews:[],isCreateReviewModalOpened:!1}},computed:{averageReview:function(){var e=this;return this.reviews.reduce((function(t,a){return t+a.grade/e.reviews.length}),0)}},methods:{getReviews:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$callWithErrorHandler(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getReviewsByShopItemId(e.shopItem.id);case 2:e.reviews=t.sent.data;case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))()},openCreateReviewModal:function(){this.isCreateReviewModalOpened=!0},closeCreateReviewModal:function(e){this.isCreateReviewModalOpened=!1,e&&this.getReviews()}},watch:{shopItem:function(){this.getReviews()}},beforeMount:function(){this.getReviews()}},A=j,D=Object(u["a"])(A,r,n,!1,null,null,null);t["a"]=D.exports;d()(D,{VBtn:C["a"],VRating:v["a"]})},"5cfd":function(e,t,a){"use strict";a("93d0")},6311:function(e,t,a){"use strict";a("8f4e")},6878:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isAccessAllowed?a("v-container",{staticClass:"d-flex"},[a("v-col",[a("div",[a("h2",{staticClass:"seller-profile-page__header"},[e._v(e._s(e.shopItem.name))]),a("div",{staticClass:"seller-profile-page__seller-profile-info-container"},[a("div",{staticClass:"mr-2 mb-2"},[a("v-img",{staticClass:"seller-profile-page__sellerProfile-avatar",attrs:{src:e.shopItemAvatar,alt:"Аватар пользователя"}}),a("v-btn",{staticClass:"seller-profile-page__change-avatar-btn",attrs:{color:"primary",dark:""},on:{click:e.openChangeShopItemAvatarModal}},[e._v(" Заменить фото ")])],1),a("v-col",[a("label",{staticClass:"text-caption",attrs:{for:"description-field"}},[e._v("Описание")]),a("p",{attrs:{name:"description-field"}},[e._v(e._s(e.shopItem.description))]),a("label",{staticClass:"text-caption",attrs:{for:"phone-field"}},[e._v("Количество")]),a("p",{attrs:{name:"phone-field"}},[e._v(" "+e._s(e.shopItem.count)+" ("+e._s(e.shopItem.unitName)+") ")]),e.shopItem.ShopItemCategory?a("v-chip",{staticClass:"category-chip",attrs:{color:"primary",label:"",outlined:""}},[e._v(e._s(e.shopItem.ShopItemCategory.name)+" ")]):e._e(),e.shopItem.isPublished?e._e():a("div",[a("p",[e._v("Товар не опубликован")]),a("v-btn",{staticClass:"publish-btn",attrs:{color:"primary",dark:""},on:{click:e.openPublishShopItemModal}},[e._v(" Опубликовать ")])],1),a("v-btn",{staticClass:"update-btn",attrs:{color:"primary"},on:{click:e.openChangeShopItemDataModal}},[e._v("Изменить данные")])],1)],1)]),a("label",{staticClass:"text-caption d-block mt-3"},[e._v("Материалы")]),a("assets-slider",{attrs:{mutable:!0,type:"shopItem",shopItem:e.shopItem},on:{update:e.getShopItem}})],1),a("v-divider",{attrs:{vertical:""}}),a("v-col",[a("h2",[e._v("Отзывы")]),a("reviews",{attrs:{shopItem:e.shopItem,mutable:!1}})],1),a("upload-asset-modal",{attrs:{isOpened:e.isChangeShopItemAvatarModalOpened,title:"Изменение аватара товара",buttonLabel:"Заменить"},on:{close:e.closeChangeShopItemAvatarModal}}),a("change-shop-item-data-modal",{attrs:{isOpened:e.isChangeShopItemDataModalOpened,shopItem:e.shopItem},on:{close:e.closeChangeShopItemDataModal}}),a("confirmation-modal",{attrs:{isOpened:e.isDeleteShopItemModalOpened,title:"Удаление товара",text:"Вы уверены, что хотите удалить товар? Это действие\n      нельзя будет отменить",buttonLabel:"Удалить"},on:{close:e.closeDeleteShopItemModal,confirm:function(t){return e.closeDeleteShopItemModal(!0)}}}),a("confirmation-modal",{attrs:{isOpened:e.isPublishShopItemModalOpened,title:"Публикация товара",text:"Вы уверены, что хотите опубликовать товар? Это действие\n      нельзя будет отменить",buttonLabel:"Опубликовать"},on:{close:e.closePublishShopItemModal,confirm:function(t){return e.closePublishShopItemModal(!0)}}})],1):e._e()},n=[],i=a("5530"),o=a("1da1"),s=(a("96cf"),a("99af"),a("0f7b")),c=a("12c8"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{"max-width":"600"},on:{"click:outside":function(t){return e.$emit("close")}},model:{value:e.isOpened,callback:function(t){e.isOpened=t},expression:"isOpened"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5 grey lighten-2"},[e._v(" Создание товара ")]),a("v-card-text",[a("v-form",{model:{value:e.isFormValid,callback:function(t){e.isFormValid=t},expression:"isFormValid"}},[a("v-text-field",{attrs:{label:"Название",rules:e.nameInputRules,"validate-on-blur":""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("v-text-field",{attrs:{label:"Описание",rules:e.descriptionInputRules,"validate-on-blur":""},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),a("v-select",{attrs:{items:e.categories,"item-text":"name","return-object":"",hint:"Укажите категорию товара","persistent-hint":""},model:{value:e.pickedCategory,callback:function(t){e.pickedCategory=t},expression:"pickedCategory"}}),a("v-text-field",{attrs:{label:"Количество",rules:e.countInputRules,"validate-on-blur":""},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}}),a("v-checkbox",{attrs:{label:"Продается штучно"},model:{value:e.isUnitInteger,callback:function(t){e.isUnitInteger=t},expression:"isUnitInteger"}}),a("v-text-field",{attrs:{label:"Единица измерения",rules:e.unitNameInputRules,"validate-on-blur":""},model:{value:e.unitName,callback:function(t){e.unitName=t},expression:"unitName"}})],1)],1),a("v-divider"),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:"",loading:e.isLoading,disabled:!e.isFormValid},on:{click:e.updateShopItem}},[e._v("Изменить")])],1)],1)],1)},u=[],p=(a("b0c0"),a("a4d3"),a("e01a"),{props:{isOpened:{type:Boolean,required:!0},shopItem:{type:Object,required:!0}},data:function(){return{name:"",description:"",isFormValid:!1,isLoading:!1,nameInputRules:[function(e){return!!e||"Заполните поле"},function(e){return(e||"").length>=3||"Минимальное число символов - 3"},function(e){return(e||"").length<=40||"Максимальное число символов - 40"}],descriptionInputRules:[function(e){return!!e||"Заполните поле"}],unitNameInputRules:[function(e){return!!e||"Заполните поле"}],countInputRules:[function(e){return!!e||"Заполните поле"},function(e){return+e>=0||"Значение не может быть отрицательным!"}],categories:[],pickedCategory:null,count:"",unitName:"",isUnitInteger:!1}},methods:{updateShopItem:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isFormValid){t.next=6;break}return e.isLoading=!0,t.next=4,e.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.updateShopItem({id:e.shopItem.id,name:e.name,description:e.description,category:e.pickedCategory,count:e.count,isPublished:e.shopItem.isPublished,unitName:e.unitName,isUnitInteger:e.isUnitInteger});case 2:case"end":return t.stop()}}),t)}))));case 4:e.isLoading=!1,e.$emit("close",!0);case 6:case"end":return t.stop()}}),t)})))()},getShopItemCategories:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getShopItemCategories();case 2:e.categories=t.sent.data;case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))()}},watch:{isOpened:function(){this.name=this.shopItem.name,this.description=this.shopItem.description,this.pickedCategory=this.shopItem.ShopItemCategory,this.unitName=this.shopItem.unitName,this.isUnitInteger=this.shopItem.isUnitInteger,this.count=this.shopItem.count}},beforeMount:function(){this.getShopItemCategories()}}),d=p,h=a("2877"),m=a("6544"),v=a.n(m),f=a("8336"),g=a("b0af"),I=a("99d9"),b=a("ac7c"),w=a("169a"),x=a("ce7e"),C=a("4bd4"),R=a("b974"),S=a("2fa4"),O=a("8654"),k=Object(h["a"])(d,l,u,!1,null,"38a105b6",null),_=k.exports;v()(k,{VBtn:f["a"],VCard:g["a"],VCardActions:I["a"],VCardText:I["b"],VCardTitle:I["c"],VCheckbox:b["a"],VDialog:w["a"],VDivider:x["a"],VForm:C["a"],VSelect:R["a"],VSpacer:S["a"],VTextField:O["a"]});var M=a("cc2c"),V=a("2c2a"),y={components:{ConfirmationModal:s["a"],UploadAssetModal:c["a"],ChangeShopItemDataModal:_,AssetsSlider:M["a"],Reviews:V["a"]},data:function(){return{isAccessAllowed:!1,isChangeShopItemAvatarModalOpened:!1,isChangeShopItemDataModalOpened:!1,isDeleteShopItemModalOpened:!1,isPublishShopItemModalOpened:!1,shopItem:null,sellerProfile:null}},computed:{shopItemAvatar:function(){var e;return null!==(e=this.shopItem)&&void 0!==e&&e.avatar?"".concat(this.$api.BASE_URL).concat(this.shopItem.avatar):a("113c")}},methods:{getShopItem:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getShopItem(e.$route.params.id);case 2:e.shopItem=t.sent.data;case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))()},getSellerProfile:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getUserSellerProfile();case 2:e.sellerProfile=t.sent.data;case 3:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))()},openChangeShopItemAvatarModal:function(){this.isChangeShopItemAvatarModalOpened=!0},closeChangeShopItemAvatarModal:function(e){var t=this;this.isChangeShopItemAvatarModalOpened=!1,e&&this.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$api.updateShopItemAvatar({avatar:e},t.shopItem.id);case 2:t.getShopItem();case 3:case"end":return a.stop()}}),a)}))))},openChangeShopItemDataModal:function(){this.isChangeShopItemDataModalOpened=!0},closeChangeShopItemDataModal:function(e){this.isChangeShopItemDataModalOpened=!1,e&&this.getShopItem()},openDeleteShopItemModal:function(){this.isDeleteShopItemModalOpened=!0},closeDeleteShopItemModal:function(e){var t=this;this.isDeleteShopItemModalOpened=!1,e&&this.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.deleteShopItem(t.shopItem.id);case 2:t.$router.push("/seller-profile");case 3:case"end":return e.stop()}}),e)}))))},openPublishShopItemModal:function(){this.isPublishShopItemModalOpened=!0},closePublishShopItemModal:function(e){var t=this;this.isPublishShopItemModalOpened=!1,e&&this.$callWithErrorHandler(Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.updateShopItem(Object(i["a"])(Object(i["a"])({},t.shopItem),{},{category:t.shopItem.ShopItemCategory,isPublished:!0}));case 2:t.getShopItem();case 3:case"end":return e.stop()}}),e)}))))}},beforeMount:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getShopItem();case 2:return t.next=4,e.getSellerProfile();case 4:e.shopItem.ownerId===e.sellerProfile.id?e.isAccessAllowed=!0:e.$router.push("/shop-item/".concat(e.$route.params.id));case 5:case"end":return t.stop()}}),t)})))()}},$=y,j=(a("6311"),a("cc20")),A=a("62ad"),D=a("a523"),P=a("adda"),F=Object(h["a"])($,r,n,!1,null,"d29d97ce",null);t["default"]=F.exports;v()(F,{VBtn:f["a"],VChip:j["a"],VCol:A["a"],VContainer:D["a"],VDivider:x["a"],VImg:P["a"]})},"8f4e":function(e,t,a){},"93d0":function(e,t,a){}}]);
//# sourceMappingURL=chunk-5621a502.32b60abf.js.map